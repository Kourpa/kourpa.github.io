(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7825:(e,t,a)=>{Promise.resolve().then(a.bind(a,6322))},6322:(e,t,a)=>{"use strict";a.d(t,{default:()=>k});var n=a(5155),s=a(2115);let r=e=>{let{label:t,onClick:a}=e;return(0,n.jsx)("button",{onClick:()=>{console.log("".concat(t," button clicked")),a()},className:" font-mono px-1  py-.5  text-gray-500  hover:text-green-500 ",children:t})};class l{async connect(){return this.db?this.db:new Promise((e,t)=>{let a=indexedDB.open(this.config.name,this.config.version);a.onerror=()=>t(a.error),a.onsuccess=()=>{this.db=a.result,e(this.db)},a.onupgradeneeded=e=>{let t=e.target.result;for(let[e,n]of Object.entries(this.config.stores))if(!t.objectStoreNames.contains(e)){var a;let s=t.createObjectStore(e,{keyPath:n.keyPath});null===(a=n.indexes)||void 0===a||a.forEach(e=>{let{name:t,keyPath:a,options:n}=e;s.createIndex(t,a,n)})}}})}async add(e,t){let a=await this.connect();return new Promise((n,s)=>{let r=a.transaction(e,"readwrite").objectStore(e).add(t);r.onsuccess=()=>n(r.result),r.onerror=()=>s(r.error)})}async get(e,t){let a=await this.connect();return new Promise((n,s)=>{let r=a.transaction(e,"readonly").objectStore(e).get(t);r.onsuccess=()=>n(r.result),r.onerror=()=>s(r.error)})}async getAll(e){let t=await this.connect();return new Promise((a,n)=>{let s=t.transaction(e,"readonly").objectStore(e).getAll();s.onsuccess=()=>a(s.result),s.onerror=()=>n(s.error)})}async update(e,t){let a=await this.connect();return new Promise((n,s)=>{let r=a.transaction(e,"readwrite").objectStore(e).put(t);r.onsuccess=()=>n(r.result),r.onerror=()=>s(r.error)})}async delete(e,t){let a=await this.connect();return new Promise((n,s)=>{let r=a.transaction(e,"readwrite").objectStore(e).delete(t);r.onsuccess=()=>n(),r.onerror=()=>s(r.error)})}async query(e,t,a){let n=await this.connect();return new Promise((s,r)=>{let l=n.transaction(e,"readonly").objectStore(e).index(t).getAll(a);l.onsuccess=()=>s(l.result),l.onerror=()=>r(l.error)})}async clear(e){let t=await this.connect();return new Promise((a,n)=>{let s=t.transaction(e,"readwrite").objectStore(e).clear();s.onsuccess=()=>a(),s.onerror=()=>n(s.error)})}close(){this.db&&(this.db.close(),this.db=null)}constructor(e){this.db=null,this.config=e}}let o=new l({name:"shell",version:1,stores:{weeks:{keyPath:"_id",indexes:[{name:"week",keyPath:"week",options:{unique:!0}},{name:"user",keyPath:"user"}]},goals:{keyPath:"_id",indexes:[{name:"name",keyPath:"week",options:{unique:!0}},{name:"user",keyPath:"user"}]}}}),c=(0,s.createContext)({key:"",week:{},day:{},goals:[],date:new Date,addGoal:()=>{},removeGoal:()=>{},saveWeek:()=>{},resetWeek:()=>{},saveDay:()=>{},updateSelectedWeek:()=>{},updateSelectedDay:()=>{}}),i=()=>(0,s.useContext)(c),d=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new Date(new Date(e,0,1).getTime()+6048e5*t+864e5*a);return new Date(n.getFullYear(),n.getMonth(),n.getDate())},u=e=>{let t=new Date(e.getFullYear(),0,1);return Math.floor(Math.floor((e.getTime()-t.getTime())/864e5)/7)},x=e=>Math.floor((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5)%7,g=async(e,t,a,n)=>{let s="week_".concat(t,"-W").concat(a,"_").concat(e),r=await o.get("weeks",s);return r||(r={_id:s,user:e,year:t,week:a,goals:n,days:Array(7).fill({day:0,note:"",goals:[]}).map((e,t)=>({...e,day:t}))},await o.add("weeks",r)),r},h=async e=>{await o.update("weeks",e)},m=async()=>await o.getAll("goals"),f=async e=>{await o.add("goals",e)},b=async e=>{await o.delete("goals",e._id)},y=e=>{let{children:t}=e,a=new Date,[r,l]=(0,s.useState)(a.getFullYear()),[i,y]=(0,s.useState)(u(a)),[p,j]=(0,s.useState)(x(a)),[v,w]=(0,s.useState)(),[N,C]=(0,s.useState)(),[k,_]=(0,s.useState)([]),[S,D]=(0,s.useState)(!1),[P,E]=(0,s.useState)(d(r,i,p)),G="".concat(r,"-W").concat(i+1);(0,s.useEffect)(()=>{(async()=>{await o.connect(),D(!0),_(await m())})()},[]),(0,s.useEffect)(()=>{S&&(async()=>{let e=await g("user",r,i,k);w(e),C(e.days[p])})()},[i,S]),(0,s.useEffect)(()=>{S&&C(null==v?void 0:v.days[p])},[p]),(0,s.useEffect)(()=>{E(d(r,i,p))},[r,i,p]);let T=e=>{h(e),w(e)};if(!S||!v||!N)return(0,n.jsx)(n.Fragment,{children:"Loadding...."});let A=e=>{let t=i+e,a=r;t<0?(t=52+t,a--):t>51&&(t%=52,a++),l(a),y(t)};return(0,n.jsx)(c.Provider,{value:{key:G,day:N,week:v,goals:k,date:P,addGoal:e=>{f(e),_(t=>[...t,e])},removeGoal:e=>{b(e),_(t=>t.filter(t=>t._id!==e._id))},saveWeek:T,resetWeek:e=>{let t=structuredClone(e);t.goals=k,t.days=t.days.map(e=>({...e,goals:[]})),h(t),w(t)},saveDay:e=>{if(!v)return;let t=structuredClone(v);t.days[p]=e,T(t),C(e)},updateSelectedWeek:A,updateSelectedDay:e=>{let t=p+e;t<0?(t=7+t,A(-1)):t>6&&(t%=7,A(1)),j(t),E(d(r,i,t))}},children:t})},p=e=>{let{label:t="",value:a=!1,disabled:r=!1,className:l="",onChange:o=()=>{}}=e,[c,i]=(0,s.useState)(a),d=()=>{let e=!c;i(e),o(e)};return(0,n.jsxs)("button",{onClick:()=>!r&&d(),disabled:r,className:"\n        font-mono \n        text-sm\n        ".concat(r?"text-gray-600":"text-green-500","\n        ").concat(l,"\n      "),children:[c?"[x]":"[ ]"," ".concat(t)]})},j=()=>{var e;let{key:t,week:a,goals:r,saveWeek:l,resetWeek:o,addGoal:c,removeGoal:d,updateSelectedWeek:u}=i(),[x,g]=(0,s.useState)(!1),[h,m]=(0,s.useState)({name:"",targetCount:0,initialCount:0,repeating:!1}),f=e=>{l(e)},b=()=>{var e;if(!h.name||!a)return;let t={...h,_id:"goal_".concat(a._id,"_").concat(Math.floor(Date.now()/1e3)),currentCount:null!==(e=h.initialCount)&&void 0!==e?e:0,completions:[]};h.repeating?c({...t,_id:"goal_repeating_".concat(Date.now()/1e3)}):f({...a,goals:[...a.goals,t]}),m({name:"",targetCount:0,initialCount:0,repeating:!1}),g(!1)},y=e=>{a&&f({...a,goals:a.goals.filter(t=>t._id!==e._id)})},j=e=>{a&&d(e)};return(0,n.jsxs)("div",{className:"flex flex-col gap-4 p-6",children:[(0,n.jsx)("div",{className:"w-full h-full font-mono text-gray-500 rounded-lg",children:(0,n.jsxs)("div",{className:"mb-6 border-b border-gray-500 flex justify-between content-center",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("h1",{className:"text-xl self-center",children:t}),(0,n.jsx)("button",{className:"text-xl hover:text-green-500",onClick:()=>o(a),children:"reset"})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)("button",{onClick:()=>u(-1),className:"px-3 py-1 rounded hover:text-green-500",children:["<"," Prev"]}),(0,n.jsxs)("button",{onClick:()=>u(1),className:"px-3 py-1 rounded hover:text-green-500",children:["Next ",">"]})]})]})}),(0,n.jsx)("div",{className:"w-full h-full font-mono text-gray-500 rounded-lg",children:x?(0,n.jsxs)("div",{className:"mt-6 border border-gray-800 p-4 rounded-lg flex flex-col gap-1",children:[(0,n.jsx)("span",{children:"NAME:"}),(0,n.jsx)("input",{type:"text",value:h.name,onChange:e=>m(t=>({...t,name:e.target.value})),placeholder:"> Enter activity name...",className:"w-full bg-transparent border-b border-gray-500 mb-4 px-2 py-1 focus:outline-none"}),(0,n.jsx)("span",{children:"TARGET:"}),(0,n.jsx)("input",{type:"number",value:h.targetCount,onChange:e=>m(t=>({...t,targetCount:parseInt(e.target.value)||0})),placeholder:"> Enter target count...",className:"w-full bg-transparent border-b border-gray-500 mb-4 px-2 focus:outline-none"}),(0,n.jsx)("span",{children:"INITIAL:"}),(0,n.jsx)("input",{type:"number",value:h.initialCount,onChange:e=>m(t=>({...t,initialCount:parseInt(e.target.value)||0})),placeholder:"> Enter initial count...",className:"w-full bg-transparent border-b border-gray-500 mb-4 px-2 focus:outline-none"}),(0,n.jsx)(p,{label:"repeating",className:"self-end text-gray-500 hover:text-green-500",onChange:e=>m(t=>({...t,repeating:e}))}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)("button",{onClick:()=>b(),className:"px-3 hover:text-green-500 border border-gray-500 rounded",children:"Add Goal"}),(0,n.jsx)("button",{onClick:()=>g(!1),className:"px-3 hover:text-green-500",children:"Cancel"})]})]}):(0,n.jsx)("button",{onClick:()=>g(!0),className:"w-full mt-6 px-3 rounded hover:text-green-500",children:"+ New Goal"})}),(0,n.jsxs)("div",{className:"w-full h-full font-mono text-gray-500",children:[(0,n.jsx)("div",{className:"border-b border-gray-500 mb-1",children:(0,n.jsxs)("h2",{className:"text-lg self-center",children:["Goals: ",null==a?void 0:null===(e=a.goals)||void 0===e?void 0:e.length]})}),(0,n.jsx)("div",{className:"space-y-1",children:null==a?void 0:a.goals.map(e=>(0,n.jsxs)("button",{className:"flex w-full justify-between items-center hover:text-red-900",onClick:()=>y(e),children:[(0,n.jsx)("span",{className:"text-lg",children:e.name}),(0,n.jsx)("span",{className:"text-lg",children:"[x]"})]},e._id))})]}),(0,n.jsxs)("div",{className:"w-full h-full font-mono text-gray-500",children:[(0,n.jsx)("div",{className:"border-b border-gray-500 mb-1",children:(0,n.jsxs)("h2",{className:"text-lg self-center",children:["Repeating Goals: ",null==r?void 0:r.length]})}),(0,n.jsx)("div",{className:"space-y-1",children:r.map(e=>(0,n.jsxs)("button",{className:"flex w-full justify-between items-center hover:text-red-900",onClick:()=>j(e),children:[(0,n.jsx)("span",{className:"text-lg",children:e.name}),(0,n.jsx)("span",{className:"text-lg",children:"[x]"})]},e._id))})]})]})},v=e=>{let{value:t="",onChange:a=()=>{}}=e;return(0,n.jsx)("div",{className:"flex flex-1 w-full h-full",children:(0,n.jsx)("textarea",{value:t,onChange:e=>{a(e.target.value)},className:" w-full bg-black  text-gray-500  placeholder-gray-700 p-2  border  rounded  border-gray-800  focus:border-gray-700  focus:outline-none ",placeholder:"Type something...",spellCheck:!1})})},w=e=>{let{className:t=""}=e,{week:a,saveWeek:s}=i(),r=a.goals,l=e=>{let t=0;0===e.targetCount?e.currentCount>0&&(t=e.currentCount-1):e.currentCount<e.targetCount&&(t=e.currentCount+1);let n={...e,currentCount:t,completions:[...e.completions,new Date]},r=structuredClone(a);r.goals=r.goals.map(t=>e._id!==t._id?t:n),s(r)};return r.length?(0,n.jsx)("div",{className:"font-mono text-gray-500 space-y-2 ".concat(t),children:r.map(e=>(0,n.jsxs)("div",{className:"flex items-centeweek_2025r justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("span",{children:[e.name," "]}),(0,n.jsxs)("span",{className:"ml-2",children:[e.currentCount,"/",e.targetCount||e.initialCount]})]}),(0,n.jsx)("div",{className:"flex space-x-2",children:0===e.targetCount?(0,n.jsx)("button",{onClick:()=>l(e),disabled:0===e.currentCount,className:"px-2 disabled:text-gray-600",children:"[-]"}):(0,n.jsx)("button",{onClick:()=>l(e),disabled:e.currentCount===e.targetCount,className:"px-2 disabled:text-gray-600",children:"[+]"})})]},e._id))}):null},N=()=>{var e;let{key:t,week:a,day:s,date:r,saveDay:l,updateSelectedDay:o}=i();return(0,n.jsxs)("div",{className:"flex flex-col flex-1 gap-4",children:[(0,n.jsxs)("div",{className:"text-gray-500 flex justify-between",children:[(0,n.jsx)("button",{className:"hover:text-green-500",onClick:()=>o(-1),children:"<"}),(0,n.jsxs)("span",{children:[t," #",s.day+1]}),(0,n.jsx)("span",{className:"text-gray-600",children:r.toLocaleDateString()}),(0,n.jsx)("button",{className:" enabled:hover:text-green-500 enabled:text-gray-500 disabled:text-gray-700 ",disabled:function(e){let t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(r),onClick:()=>o(1),children:">"})]}),(null==a?void 0:null===(e=a.goals)||void 0===e?void 0:e.length)>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:"text-lg text-gray-500",children:"Goals"}),(0,n.jsx)(w,{})]}),(0,n.jsx)("h2",{className:"text-lg text-gray-500",children:"Notes"}),(0,n.jsx)(v,{value:s.note,onChange:e=>{l({...s,note:e})}})]})},C=()=>{let[e,t]=(0,s.useState)(new Date);return(0,s.useEffect)(()=>{let e=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(e)},[]),"".concat(e.toLocaleDateString()," ").concat(e.toLocaleTimeString())},k=()=>{let[e,t]=(0,s.useState)(!1);return(0,n.jsx)(y,{children:(0,n.jsxs)("div",{className:"mx-auto p-5 space-y-6 bg-black min-h-screen flex flex-col",children:[(0,n.jsxs)("div",{className:"flex column justify-between text-gray-600 font-mono mb-4",children:[(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"$ shell v1.0.0"}),(0,n.jsx)("div",{className:"text-sm text-gray-600",children:(0,n.jsx)(C,{})}),(0,n.jsx)(r,{label:"manage",onClick:()=>{t(!e)}})]}),e?(0,n.jsx)(j,{}):(0,n.jsx)(N,{})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(7825)),_N_E=e.O()}]);